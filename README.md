**The CDC Universal Parasite Diagnostic Assay Workflow - Test Version**

This github repository contains a test version of a workflow used for the Universal Parasite Diagnostic Assay (UPDx) conducted at the Centers for Disease Control and Prevention. It is used to take in sequences in fastq format and produce detailed summary reports, via R-Markdown, for each sample detailing each step of the workflow and exactly what parasites the sample is positive for. Additionally a parasite summary report is generated for each run that concatenates all samples that went through the workflow and the parasties they are positive for. This is a test version and has not been optimized for speed or efficiency (in terms of computational resource use), but does represent a relatively stable release of the workflow. This workflow was designed to be used in a diagnostic setting, and therefore complies with CLIA regulations in terms of reproducibility, long-term storage, and crucial quality checkpoint steps. Additionally, there are further quality checkpoint steps that are specific to the UPDx assay and can be relatively edited or removed to fit with any projects specific standards. These steps and the lines of code in which they are located are detailed in the Installation and Usage Guide found on this page. 

Here is a brief summary of the primary steps of the workflow:

**FQC:** FastQC is used to perform a quality check on the sequences both before and after the sequences undergo quality trimming via BBDuk. The stats of these checks are stored in a text file generated by the workflow and an overall summary table created for each sample that is displayed on the summary reports (mentioned below). Afterwards there are specific quality checks that are performed for each sample that are specific to the UPDx project, explained further in the Installation and Usage Guide, and any samples that fails these checks are removed during these steps. Finally the workflow ensures that there are at least three negatives remaining as this is crucial to calculating a reliable cutoff threshold (mentioned below). The workflow is halted with an error message on the terminal and saved to a text file informing the user that there were not enough negatives remaining in the workflow. 

**CD-HIT:** CD-Hit is used by the workflow to cluster sequences at a 99% similarity threshold. This is meant to mimic the clustering that takes place during the sequencing process in which each cluster has one representative sequence and thus in future BLAST steps we only have to BLAST the representative sequence once rather than the 
 same sequence repeatedly. The cluster number, representative sequence, SeqID for the representative sequence, and the number of sequences in the cluster are all saved and displayed in a Cluster summary table that is displayed on the summary reports. Any clusters made up of less than 20 sequences are removed from the workflow. 
 
**BLAST:** The workflow performs two BLAST steps using databases curated for the UPDx project. More information on these databases can be found in the Installation and Usage Guide. 
